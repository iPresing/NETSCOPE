{# Health Score Widget Component - Story 3.2
   Displays network health score with circular SVG gauge.

   Parameters:
     health_score: dict - HealthScoreResult.to_dict() data (optional)
       - displayed_score: int (0-100)
       - real_score: int (0-100)
       - status_color: str ('normal', 'warning', 'critical')
       - critical_count: int
       - warning_count: int
       - whitelist_hits: int
       - whitelist_impact: int
#}

{% set score = health_score.displayed_score if health_score else none %}
{% set status = health_score.status_color if health_score else 'normal' %}
{% set has_data = health_score is not none and score is not none %}

{# Calculate gauge offset: 283 = full circumference, 0 = complete circle #}
{% set gauge_offset = 283 - (283 * (score or 0) / 100) %}

<div class="health-score-widget {{ '' if has_data else 'health-score-widget--empty' }}"
     id="health-score-widget"
     data-score="{{ score if score is not none else '' }}"
     data-status="{{ status }}">

    <div class="health-score-widget__gauge-container">
        {# SVG Circular Gauge #}
        <svg class="health-gauge" viewBox="0 0 100 100">
            {# Background circle #}
            <circle class="health-gauge__bg" cx="50" cy="50" r="45" />
            {# Progress circle #}
            <circle class="health-gauge__progress health-gauge__progress--{{ status }}"
                    cx="50" cy="50" r="45"
                    stroke-dasharray="283"
                    stroke-dashoffset="{{ gauge_offset }}" />
        </svg>

        {# Score display centered in gauge #}
        <div class="health-score-widget__score">
            <span class="health-score-widget__value {{ 'health-score-widget__value--' + status if has_data else '' }}">
                {{ score if has_data else '--' }}
            </span>
            <span class="health-score-widget__max">/100</span>
        </div>
    </div>

    {# Status label #}
    <div class="health-score-widget__status health-score-widget__status--{{ status }}">
        {% if has_data %}
            {% if status == 'normal' %}
                R&eacute;seau Sain
            {% elif status == 'warning' %}
                Attention
            {% else %}
                Critique
            {% endif %}
        {% else %}
            Score Sant&eacute;
        {% endif %}
    </div>

    {# Empty state message #}
    <span class="health-score-widget__empty-message" {% if has_data %}style="display: none;"{% endif %}>
        Lancez une capture pour voir le score
    </span>

    {# Details button - hidden until data available #}
    <button class="health-score-widget__details"
            id="btn-health-score-details"
            {% if not has_data %}style="display: none;"{% endif %}>
        D&eacute;tails &rarr;
    </button>
</div>
